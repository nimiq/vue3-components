{"version":3,"file":"vue3-components2.js","sources":["../../../../src/components/QrCode/QrCode.vue"],"sourcesContent":["<template>\n    <canvas ref=\"canvas$\" v-if=\"!!data\" class=\"qr-code\"></canvas>\n</template>\n\n<script lang=\"ts\">\nimport { defineComponent, watch, nextTick, ref } from 'vue'\n\nimport QrCreator from 'qr-creator';\n\nexport enum QrCodeErrorCorrection {\n    L = 'L',\n    M = 'M',\n    H = 'H',\n    Q = 'Q',\n}\n\n/**\n * **Nimiq QR Code Component**\n *\n * Props:\n *\n * **data** {string} The data to render\n *\n * **errorCorrection** {'L', 'M', 'H', 'Q'} [optional, default: 'M'] Error correction level according to QR specs\n *\n * **radius** {number} [optional, default .5] Roundness of QR code modules. Recommended value: .5\n *\n * **fill** {string|LinearGradient|RadialGradient} [optional, default '#0582ca' (nimiq-light-blue)] Fill of QR code\n *\n * **background** {string|null} [optional, default null] Background color of QR code. null means transparent.\n *\n * **size** {number} [optional, default 240] Width and height of QR code\n *\n * The QR encoder lib itself is lazy loaded as a webpack chunk when the data is set. If you want to use the QrCode\n * component in your project, you should copy the chunk from the dist folder over to your project.\n */\nexport default defineComponent({\n    name: 'QrCode',\n    props: {\n        data: String,\n        errorCorrection: {\n            type: String as () => QrCodeErrorCorrection,\n            default: QrCodeErrorCorrection.M,\n            validator: (value: any) => Object.values(QrCodeErrorCorrection).includes(value)\n        },\n        radius: {\n            type: Number,\n            default: .5,\n            validator: (value: number) => value >= 0 && value <= 1\n        },\n        fill: {\n            type: [String, Object as () => QrCreator.LinearGradient, Object as () => QrCreator.RadialGradient],\n            default: () => ({ // default equivalent to nimiq-light-blue-bg\n                type: 'radial-gradient',\n                // circle centered in bottom right corner with radius of the size of qr code diagonal\n                position: [1, 1, 0, 1, 1, Math.sqrt(2)],\n                colorStops: [\n                    [0, '#265DD7'],\n                    [1, '#0582CA'], // nimiq-light-blue\n                ],\n            }),\n            validator: (fill: Object) => {\n                const isValidColor = (c: unknown) => typeof(c) === 'string' && /^#([0-9a-f]{6}|[0-9a-f]{8})$/i.test(c);\n\n                if (isValidColor(fill)) return true;\n\n                const gradient = (fill as QrCreator.LinearGradient | QrCreator.RadialGradient);\n                const isValidGradient = ((gradient.type === 'linear-gradient' && gradient.position.length === 4)\n                    || (gradient.type === 'radial-gradient' && gradient.position.length === 6))\n                    && gradient.position.every((coordinate) => typeof coordinate === 'number');\n\n                if (!isValidGradient) return false;\n\n                const hasValidGradientStops = gradient.colorStops.length >= 2\n                    && gradient.colorStops.every(([offset, color]) => typeof(offset) === 'number' && isValidColor(color));\n\n                return hasValidGradientStops;\n            },\n        },\n        background: {\n            type: String,\n            default: null,\n            validator: (background: string) => background === null || /^#([0-9a-f]{6}|[0-9a-f]{8})$/i.test(background)\n        },\n        size: {\n            type: Number,\n            default: 240,\n            validator: (size: number) => size > 0,\n        },\n    },\n    setup(props, context) {\n        const canvas$ = ref<HTMLCanvasElement | null>(null);\n\n        async function toDataUrl(type = 'image/png') {\n            await nextTick(); // Make sure the canvas is in the DOM (it depends on !!data)\n            if (!props.data || !canvas$.value) return 'data:,';\n            return canvas$.value.toDataURL(type);\n        }\n\n        watch([\n            () => props.data,\n            () => props.errorCorrection,\n            () => props.radius,\n            () => props.fill,\n            () => props.background,\n            () => props.size,\n        ], async () => {\n            await nextTick(); // Make sure the canvas is in the DOM (it depends on !!data)\n            if (!props.data || !canvas$.value) return;\n            QrCreator.render({\n                text: props.data,\n                radius: props.radius,\n                ecLevel: props.errorCorrection,\n                fill: props.fill,\n                background: props.background,\n                size: props.size,\n            }, canvas$.value);\n        }, { immediate: true });\n\n        context.expose({\n            toDataUrl,\n        });\n\n        return {\n            data: props.data,\n            canvas$,\n        };\n    }\n})\n</script>\n"],"names":["QrCodeErrorCorrection","_sfc_main","defineComponent","value","fill","isValidColor","c","gradient","coordinate","offset","color","background","size","props","context","canvas$","ref","toDataUrl","type","nextTick","watch","QrCreator"],"mappings":";;AASY,IAAAA,sBAAAA,OACRA,EAAA,IAAI,KACJA,EAAA,IAAI,KACJA,EAAA,IAAI,KACJA,EAAA,IAAI,KAJIA,IAAAA,KAAA,CAAA,CAAA;AA2BZ,MAAAC,IAAeC,EAAgB;AAAA,EAC3B,MAAM;AAAA,EACN,OAAO;AAAA,IACH,MAAM;AAAA,IACN,iBAAiB;AAAA,MACb,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW,CAACC,MAAe,OAAO,OAAOH,CAAqB,EAAE,SAASG,CAAK;AAAA,IAClF;AAAA,IACA,QAAQ;AAAA,MACJ,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW,CAACA,MAAkBA,KAAS,KAAKA,KAAS;AAAA,IACzD;AAAA,IACA,MAAM;AAAA,MACF,MAAM,CAAC,QAAQ,QAA0C,MAAwC;AAAA,MACjG,SAAS,OAAO;AAAA,QACZ,MAAM;AAAA,QAEN,UAAU,CAAC,GAAG,GAAG,GAAG,GAAG,GAAG,KAAK,KAAK,CAAC,CAAC;AAAA,QACtC,YAAY;AAAA,UACR,CAAC,GAAG,SAAS;AAAA,UACb,CAAC,GAAG,SAAS;AAAA,QACjB;AAAA,MAAA;AAAA,MAEJ,WAAW,CAACC,MAAiB;AACnB,cAAAC,IAAe,CAACC,MAAe,OAAOA,KAAO,YAAY,gCAAgC,KAAKA,CAAC;AAErG,YAAID,EAAaD,CAAI;AAAU,iBAAA;AAE/B,cAAMG,IAAYH;AAKlB,gBAJ0BG,EAAS,SAAS,qBAAqBA,EAAS,SAAS,WAAW,KACtFA,EAAS,SAAS,qBAAqBA,EAAS,SAAS,WAAW,MACrEA,EAAS,SAAS,MAAM,CAACC,MAAe,OAAOA,KAAe,QAAQ,IAI/CD,EAAS,WAAW,UAAU,KACrDA,EAAS,WAAW,MAAM,CAAC,CAACE,GAAQC,CAAK,MAAM,OAAOD,KAAY,YAAYJ,EAAaK,CAAK,CAAC,IAH3E;AAAA,MAMjC;AAAA,IACJ;AAAA,IACA,YAAY;AAAA,MACR,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW,CAACC,MAAuBA,MAAe,QAAQ,gCAAgC,KAAKA,CAAU;AAAA,IAC7G;AAAA,IACA,MAAM;AAAA,MACF,MAAM;AAAA,MACN,SAAS;AAAA,MACT,WAAW,CAACC,MAAiBA,IAAO;AAAA,IACxC;AAAA,EACJ;AAAA,EACA,MAAMC,GAAOC,GAAS;AACZ,UAAAC,IAAUC,EAA8B,IAAI;AAEnC,mBAAAC,EAAUC,IAAO,aAAa;AAEzC,aADA,MAAMC,EAAS,GACX,CAACN,EAAM,QAAQ,CAACE,EAAQ,QAAc,WACnCA,EAAQ,MAAM,UAAUG,CAAI;AAAA,IACvC;AAEM,WAAAE,EAAA;AAAA,MACF,MAAMP,EAAM;AAAA,MACZ,MAAMA,EAAM;AAAA,MACZ,MAAMA,EAAM;AAAA,MACZ,MAAMA,EAAM;AAAA,MACZ,MAAMA,EAAM;AAAA,MACZ,MAAMA,EAAM;AAAA,IAAA,GACb,YAAY;AAEX,MADA,MAAMM,EAAS,GACX,GAACN,EAAM,QAAQ,CAACE,EAAQ,UAC5BM,EAAU,OAAO;AAAA,QACb,MAAMR,EAAM;AAAA,QACZ,QAAQA,EAAM;AAAA,QACd,SAASA,EAAM;AAAA,QACf,MAAMA,EAAM;AAAA,QACZ,YAAYA,EAAM;AAAA,QAClB,MAAMA,EAAM;AAAA,MAAA,GACbE,EAAQ,KAAK;AAAA,IAAA,GACjB,EAAE,WAAW,GAAA,CAAM,GAEtBD,EAAQ,OAAO;AAAA,MACX,WAAAG;AAAA,IAAA,CACH,GAEM;AAAA,MACH,MAAMJ,EAAM;AAAA,MACZ,SAAAE;AAAA,IAAA;AAAA,EAER;AACJ,CAAC;"}