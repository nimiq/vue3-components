{"version":3,"file":"vue3-components.js","sources":["../../../../src/components/AmountWithFee/AmountWithFee.vue"],"sourcesContent":["<template>\n    <div class=\"amount-with-fee\">\n        <AmountInput class=\"value\" v-model=\"liveAmount\" :class=\"{ invalid: !isValid && liveAmount > 0 }\" ref=\"amountInput$\" />\n        <div class=\"fee-section nq-text-s\">\n            <div v-if=\"!isValid && liveAmount\" class=\"nq-red\"><slot name=\"insufficient-balance-error\">{{ $t('Insufficient balance') }}</slot></div>\n            <div v-else>\n                <span v-if=\"fiatAmount && fiatCurrency\" class=\"fiat\">\n                    ~<FiatAmount :amount=\"fiatAmount\" :currency=\"fiatCurrency\" />\n                </span>\n                <span v-if=\"modelValue.fee\" class=\"fee\">\n                    + <Amount :amount=\"modelValue.fee\" :minDecimals=\"0\" :maxDecimals=\"5\" /> {{ $t('fee') }}\n                </span>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script lang=\"ts\">\nimport { computed, defineComponent, onMounted, ref, watch } from 'vue';\n\nimport { FiatApiSupportedFiatCurrency } from '@nimiq/utils';\nimport Amount from '../Amount/Amount.vue';\nimport AmountInput from '../AmountInput/AmountInput.vue';\nimport FiatAmount from '../FiatAmount/FiatAmount.vue';\nimport { loadI18n } from '../../i18n/I18nComposable';\n\nexport enum AmountWithFeeEvent {\n    MODELVALUE_UPDATE = 'update:modelValue',\n}\n\nexport default defineComponent({\n    name: 'AmountWithFee',\n    emits: Object.values(AmountWithFeeEvent),\n    props: {\n        modelValue: {\n            type: Object as () => ({ amount: number, fee: number, isValid: boolean }),\n            default: () => ({ amount: 0, fee: 0, isValid: false }),\n        },\n        availableBalance: {\n            type: Number,\n            default: 0,\n        },\n        fiatAmount: Number,\n        fiatCurrency: String as () => FiatApiSupportedFiatCurrency,\n    },\n    methods: { $t: loadI18n('AmountWithFee') },\n    setup(props, context) {\n        const amountInput$ = ref<(typeof AmountInput) | null>(null);\n\n        const liveAmount = ref(props.modelValue.amount);\n\n        const isValid = computed(() => {\n            return liveAmount.value > 0\n                && liveAmount.value + props.modelValue.fee <= props.availableBalance;\n        });\n\n        onMounted(watchAmountChange);\n\n        watch(isValid, watchAvailableAmountChange, { immediate: true });\n        function watchAvailableAmountChange() {\n            context.emit(AmountWithFeeEvent.MODELVALUE_UPDATE, {\n                amount: liveAmount.value,\n                fee: props.modelValue.fee,\n                isValid: isValid.value,\n            });\n        }\n\n        watch(liveAmount, watchAmountChange, { immediate: true });\n        function watchAmountChange() {\n            context.emit(AmountWithFeeEvent.MODELVALUE_UPDATE, {\n                amount: liveAmount.value,\n                fee: props.modelValue.fee,\n                isValid: isValid.value,\n            });\n        }\n\n        function focus() {\n            if (amountInput$.value) amountInput$.value.focus();\n        }\n\n        context.expose({ focus });\n\n        return {\n            amountInput$,\n            liveAmount,\n            isValid,\n        };\n    },\n    components: {\n        Amount,\n        AmountInput,\n        FiatAmount,\n    },\n})\n</script>\n\n<style scoped>\n    .amount-with-fee {\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n        width: 100%;\n    }\n\n    .value {\n        display: flex;\n        align-items: baseline;\n    }\n\n    .amount-input:deep(input) {\n        padding-top: 0;\n        padding-bottom: 0;\n    }\n\n    .amount-input.invalid:deep(input),\n    .amount-input.invalid:deep(.nim) {\n        border-color: rgb(216, 65, 51, 0.2); /* Based on Nimiq Red */\n        color: var(--nimiq-red) !important;\n    }\n\n    .fee-section {\n        color: rgba(31, 35, 72, 0.5);\n        min-height: 2rem;\n    }\n\n    .fiat {\n        display: inline-flex;\n    }\n</style>\n"],"names":["_hoisted_3","_hoisted_5","_hoisted_6","_component_Amount","_resolveComponent","_openBlock","_createElementBlock","_hoisted_1","_createVNode","_component_AmountInput","_normalizeClass","_ctx","_cache","$event","_createElementVNode","_hoisted_2","_renderSlot","_hoisted_4","_createTextVNode","_component_FiatAmount","_createCommentVNode"],"mappings":";;;;;gFAI+CA,IAAc;AAAA,EAAA,KAAA;AAAA;mBAELC,IAAY;AAAA,EAAA,KAAA;AAAA;GAGxBC,IAAW;AAAA,EAAA,KAAA;AAAA;;;mDARnDC,IAAAC,EAaM,QAbN;SACiBC,EAAK,GAAAC,EAAQ,OAA0CC,GAAO;AAAA,IAA7BC,EAAAC,GAAA;AAAA,MAAA,OAAAC,EAAA,CAAA,SAAA,EAAA,SAAA,CAAAC,EAAA,WAAVA,EAAU,aAAA,EAAA,CAAA,CAAA;AAAA,MAAmD,YAAIA,EAAA;AAAA,MAAA,uBAAAC,EAAA,OAAAA,EAAA,KAAA,CAAAC,MAAAF,EAAA,aAAAE;AAAA,MACrG,KAAA;AAAA,IAAA,GAAA,MACgB,kBAAW,OAAU,CAAA;AAAA,IAAjCC,EAAA,OAAAC,GAAA;AAAA,MAAkD,CAAAJ,EAAA,WAA+EA,8BAApCX,GAAE;AAAA,QAAAgB,EAAAL,EAAA,QAAA,8BAAA,CAAA,GAAA,MAAA;AAAA;;MAE3F,CAAA,MAAAN,EAAA,GAAAC,EAAA,OAEOW,GAFP;AAAA,QAAAN,EAAA,cAAAA,EAAqD,qBACYL,EAAA,QAAAL,GAAA;AAAA,UAAvCiB,EAAA,IAAA;AAAA,UAAAV,EAAuBW,GAAY;AAAA,YAAA,QAAAR,EAAA;AAAA;;SAE7D,KAAAS,EAAA,IAAA,EAAA;AAAA,QAAAT,EAAA,WAAA,OAAAN,EAC2E,GAAAC,EAAA,QAAAJ,GAAA;AAAA,UAApDgB,EAAA,KAAA;AAAA,UAAAV,EAA4BL,GAAG;AAAA,YAAG,UAAa,WAAC;AAAA,YAAA,aAAA;AAAA;;;;;;;;;"}